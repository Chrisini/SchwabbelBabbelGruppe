#include <sys/ipc.h>
#include <sys/shm.h>
#include <stdio.h>
#include <time.h>
#define MAXMYMEM 128

int main(int argc, char **argv)
{
  int shmid; // shmid = shared memory id
  int *buf;
  int i;
  key_t key;
  srand(time(NULL)); 

  key = ftok("/etc/hostname", 'b');
  // shmget = create
  shmid = shmget(key, MAXMYMEM, IPC_CREAT | 0666);
  if (shmid >= 0) {
    buf = shmat(shmid, 0, 0);
    printf("buffer1: %d", buf);
    if (buf == NULL) {
      perror("shmat");
    }
    else
    {
      for (i=0; i<MAXMYMEM; i++) {
	  // 128 random int values
	  // from -20 to + 40
          buf[i] = rand()%60-20;
          printf("zahlen: %d",buf[i]);
      }
      printf("buffer2: %d", buf);
      getchar();
      // shmdt = detach
      shmdt(buf);
    }
  }
  else
  {
    perror("shmget");
  }
  return 0;
}





void main2(void){
	
	while(1){
		
		// Access to Sa
		
		// Initialize shared memory segment
		// 128 random int values
		// from -20 to + 40
		
		// Request acess to Sb
		// B starts to calculate
		
	}
	
}
